# Руководство по использованию системы поиска элементов и управления компьютером

Это краткое руководство поможет вам начать работу с системой для поиска элементов на экране и управления компьютером с помощью AI.

## Быстрый старт

1. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

2. Настройте API ключи в файле `api_key.txt`:
   ```json
   {
       "openai": "YOUR_OPENAI_API_KEY",
       "anthropic": "YOUR_ANTHROPIC_API_KEY"
   }
   ```

3. Запустите интерактивную программу:
   ```bash
   python main.py
   ```

## Поиск элемента на экране

Для поиска элемента на экране:

1. Сделайте скриншот экрана (опция 1 в меню)
2. Подготовьте изображение элемента, который хотите найти:
   - Сделайте скриншот нужного элемента
   - Обрежьте его до нужного размера
   - Сохраните как `element.png` в корневой папке проекта
3. Выберите опцию 2 в меню для поиска элемента

Система автоматически:
- Разделит экран на части
- Найдет часть, содержащую элемент
- Продолжит деление до точного определения положения элемента
- Вернет координаты центра элемента

## Отладочный режим

В системе есть два режима отладки, которые помогают анализировать процесс поиска элементов:

### Автоматический режим с отчетом

Выберите опцию 5 в главном меню, затем опцию 1:

1. Система выполнит поиск элемента с полным логированием всех действий
2. Создаст визуализации каждого шага деления изображения
3. Запишет ответы API на каждом этапе
4. Сгенерирует подробный HTML-отчет с результатами

После завершения отчет будет доступен в папке `debug_sessions/session_XXXXXXXXXX/debug_report.html`

### Пошаговый режим

Выберите опцию 5 в главном меню, затем опцию 2:

1. На каждом этапе поиска система будет приостанавливаться и запрашивать подтверждение для продолжения
2. Вы можете просмотреть промежуточные результаты каждого шага
3. Нажмите Enter для перехода к следующему шагу или 'q' для пропуска проверки текущей ячейки
4. Все результаты сохраняются в отчет так же, как и в автоматическом режиме

Этот режим идеально подходит для:
- Отладки проблем с распознаванием элементов
- Понимания логики рекурсивного алгоритма поиска
- Анализа ответов OpenAI API на каждом этапе

## Демонстрация работы с Finder (macOS)

Опция 3 в меню демонстрирует работу системы с приложением Finder:

1. Подготовьте файл `element.png` с изображением элемента Finder (например, кнопки или значка)
2. Выберите опцию 3 в меню
3. Система:
   - Откроет Finder
   - Сделает скриншот экрана
   - Найдет элемент
   - Кликнет по нему
   - Сделает контрольный скриншот

## Стандартный рабочий процесс

Опция 4 запускает стандартный рабочий процесс, который:
- Открывает текстовый редактор
- Вводит текст с помощью PyAutoGUI
- Демонстрирует возможности управления компьютером

## Как подготовить файл element.png

1. Сделайте скриншот экрана
2. Откройте его в любом графическом редакторе
3. Выделите элемент, который хотите найти
4. Обрежьте изображение до границ элемента
5. Сохраните как `element.png` в корневой папке проекта

Элемент должен быть:
- Четко видимым
- Без лишних элементов вокруг
- С узнаваемыми деталями

## Рекомендации по использованию

- **Размер элемента**: Элемент не должен быть слишком маленьким, система может не распознать его. Оптимальный размер - от 32x32 пикселей.
- **Уникальность**: Выбирайте элементы, которые легко отличить от других частей интерфейса.
- **Контраст**: Элементы с хорошим контрастом распознаются лучше.
- **API ключи**: Для работы с OpenAI и Anthropic требуются действительные API ключи с достаточным балансом.
- **Производительность**: Поиск элемента может занимать от нескольких секунд до минуты, в зависимости от сложности экрана и размера элемента.

## Отладка и анализ

### Основные результаты поиска

Система сохраняет результаты каждого поиска в папке `tests/test_N`, где N - номер теста. В этой папке вы найдете:
- Промежуточные квадраты поиска
- Результат с красной точкой в центре найденного элемента
- Файл с координатами
- Информационный файл о тесте

### Отладочные данные

При использовании отладочного режима в папке `debug_sessions/session_XXXXXXXXXX` сохраняются:
- Подробный лог каждого действия и API запроса
- Визуализации разделения экрана на ячейки
- Сравнение исходного изображения и искомого элемента 
- HTML-отчет с пошаговым анализом всего процесса

Это позволяет:
1. Улучшать алгоритм распознавания
2. Выявлять проблемы с распознаванием конкретных элементов
3. Оптимизировать запросы к API
4. Обучать новых пользователей работе с системой

## Запуск из командной строки

Вы также можете запускать поиск элемента с отладкой напрямую из командной строки:

```bash
# Для обычного режима
python find_element.py

# Для режима отладки с отчетом
python find_element.py --debug

# Для пошагового режима
python find_element.py --debug --step-by-step
```

Эти данные помогут вам понять, как система находит элементы и отладить проблемы с распознаванием.
